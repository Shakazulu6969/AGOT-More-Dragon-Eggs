namespace = agot_filler_crownlands

agot_filler_crownlands.0001 = {
	type = character_event
	title = agot_filler_crownlands.0001.t
	desc = agot_filler_crownlands.0001.desc

	trigger = {
		is_available = yes
		has_title = title:c_dragonstone
	}

	cooldown = { years = 100 }

	theme = court
	override_background = {
		reference = courtyard
	}
	right_portrait = {
		character = root
		animation = personality_rational
	}

	option = { # gardens
		name = {
			trigger = {
				OR = {
					character:Targaryen_27 ?= this
					game_start_date <= 8010.1.1
				}
			}
			text = agot_filler_crownlands.0001.a_normal
		}
		name = {
			trigger = {
				NOT = {
					character:Targaryen_27 ?= this
				}
				game_start_date > 8010.1.1
			}
			text = agot_filler_crownlands.0001.a_aegon
		}
		ai_chance = {
			base = 10 # Let's not have a million gardeners
			ai_value_modifier = {
				ai_boldness = -0.1
			}
		}
		random = {
			chance = 10
			add_trait = lifestyle_gardener
		}
	}

	option = { # exploring caves
		name = agot_filler_crownlands.0001.b
		ai_chance = {
			base = 30
			ai_value_modifier = {
				ai_boldness = 0.1
			}
			modifier = {
				OR = {
					has_serious_disease_trigger = yes
					has_wounds_trigger = yes
				}
				factor = 0
			}
		}
		custom_tooltip = {
			text = agot_filler_crownlands.0001.b_tt
			if = {
				limit = {
					has_game_rule = absolute_spawn
					NAND = {
						has_game_rule = ai_can_not_get_eggs
						is_ai = yes
					}
					NAND = {
						has_game_rule = ai_can_not_get_dragonstone_eggs
						is_ai = yes
					}
					NOT = { has_game_rule = spawn_dragonstone_eggs_disabled }
				}
			trigger_event = mde_dragon_eggs_events.0007
			}
			else_if = {
				limit = {
					NAND = {
						has_game_rule = ai_can_not_get_eggs
						is_ai = yes
					}
					NAND = {
						has_game_rule = ai_can_not_get_dragonstone_eggs
						is_ai = yes
					}
					NOT = { has_game_rule = no_spawns }
					NOT = { has_game_rule = spawn_dragonstone_eggs_disabled }
				}
				random_list = {
					20 = { trigger_event = agot_filler_crownlands.0002 }
					70 = { trigger_event = agot_filler_crownlands.0003 }
					10 = {
						modifier = {
							OR = { # Don't give eggs if dragons	already exist in Dragonstone
								any_in_global_list = {
									variable = living_dragons
									location.county ?= title:c_dragonstone
								}
								any_courtier = {
									has_character_flag = owned_dragon
								}
							}
							factor = 0
						}
						trigger_event = agot_filler_crownlands.0004
					}
				}
			}
			else = { }		
		}
		custom_tooltip = agot_filler_crownlands.0001.b_tt_2
	}

	option = { #relaxing
		name = agot_filler_crownlands.0001.c
		ai_chance = {
			base = 70
			modifier = {
				has_trait = diligent
				factor = 0.5
			}
		}
		stress_impact = {
			base = medium_stress_impact_loss
			lazy = minor_stress_impact_loss
			diligent = minor_stress_impact_gain
		}
	}
}

agot_filler_crownlands.0002 = {
	type = character_event
	title = agot_filler_crownlands.0002.t
	desc = agot_filler_crownlands.0002.desc
	theme = court
	right_portrait = {
		character = root
		animation = shock
	}
	override_background = {
		reference = agot_dragonstone_cave
	}

	immediate = {
		increase_wounds_effect = { REASON = wounds }
	}

	option = {
		name = agot_filler_crownlands.0002.a
	}
}

agot_filler_crownlands.0003 = {
	type = character_event
	title = agot_filler_crownlands.0003.t
	desc = agot_filler_crownlands.0003.desc
	theme = court
	right_portrait = {
		character = root
		animation = personality_rational
	}
	override_background = {
		reference = agot_dragonstone_cave
	}

	option = {
		name = agot_filler_crownlands.0003.a
		stress_impact = {
			base = medium_stress_impact_loss
		}
	}
}

agot_filler_crownlands.0004 = {
	type = character_event
	title = agot_filler_crownlands.0004.t
	desc = agot_filler_crownlands.0004.desc
	theme = court
	right_portrait = {
		character = root
		scripted_animation = mde_holding_dragon_egg_animation
	}
	artifact = {
		target = scope:epic
		position = lower_left_portrait
	}
	override_background = {
		reference = agot_dragonstone_cave
	}

	immediate = {
		custom_tooltip = agot_filler_crownlands.0004.tt
		hidden_effect = {
			random_list = {
				1 = {
					character:dragon_nessarion = { save_scope_as = dragon_parent }
				}
				1 = {
					trigger = { game_start_date >= 7935.1.1 }
					character:dragon_meraxes = { save_scope_as = dragon_parent }
				}
				1 = {
					trigger = { game_start_date >= 7959.1.1 }
					character:dragon_vhagar = { save_scope_as = dragon_parent }
				}
				1 = {
					trigger = { game_start_date >= 8017.1.1 }
					character:dragon_quicksilver = { save_scope_as = dragon_parent }
				}
				1 = {
					trigger = { game_start_date >= 8044.1.1 }
					character:dragon_dreamfyre = { save_scope_as = dragon_parent }
				}
				1 = {
					trigger = { game_start_date >= 8046.1.1 }
					character:dragon_meleys = { save_scope_as = dragon_parent }
				}
				1 = {
					trigger = { game_start_date >= 8049.1.1 }
					character:dragon_silverwing = { save_scope_as = dragon_parent }
					character:dragon_vermithor = { save_scope_as = dragon_parent_other }
				}
				1 = {
					trigger = { game_start_date >= 8097.1.1 }
					character:dragon_syrax = { save_scope_as = dragon_parent }
					character:dragon_caraxes = { save_scope_as = dragon_parent_other }
				}
			}
			agot_create_weighted_dragon_egg_artifact = { OWNER = root }
		}
	}

	option = {
		name = agot_filler_crownlands.0004.a
	}
}